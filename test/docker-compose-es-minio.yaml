version: "3"
services:
  minio:
    image: minio/minio
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      - "MINIO_ACCESS_KEY=arlaseo"
      - "MINIO_SECRET_KEY=arlaseosecret"
    command: server /export --console-address ":9001"

  createbuckets:
    image: minio/mc
    depends_on:
      - minio
    entrypoint: >
      /bin/sh -c "
      /usr/bin/mc config host add myminio http://minio:9000 arlaseo arlaseosecret;
      /usr/bin/mc rm -r --force myminio/arlaseotest;
      /usr/bin/mc mb myminio/arlaseotest;
      /usr/bin/mc anonymous set public myminio/arlaseotest;
      exit 0;
      "
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-8.7.0}
    container_name: elasticsearch
    environment:
      - discovery.type=single-node
      - cluster.name=docker-cluster
      - node.name=docker-node
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
      - xpack.security.enabled=false
      - xpack.security.http.ssl.enabled=false
      - xpack.security.transport.ssl.enabled=false
    ports:
      - 9200:9200

  rabbitmq:
    image: rabbitmq:${RABBITMQ_VERSION:-3-management}
    container_name: rabbitmq
    ports:
      - 15672:15672
      - 5672:5672

  redis:
    image: redis:${REDIS_VERSION:-7.2}
    container_name: redis
    ports:
      - 6379:6379
